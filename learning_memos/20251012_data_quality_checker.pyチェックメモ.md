・class DataQualityChecker:
    ・main()
        ・日数とプロジェクトIDのargparse作成
            ・日数はデフォルト7日
            ・プロジェクトIDはデフォルト'energy-env'
        ・checker = DataQualityChecker(args.project_id)を実行
            ・BQおよびログに必要な情報を取得
        ・results = checker.run_all_checks(args.days)を実行
            ・execution_id作成、電力、天気のチェックを行いその結果をチェックテーブルへインサート。
            　チェックの内容がダメでもログは作成されインサートされている。
            　インサート成功時は成功したことをプロセス用テーブルにログをインサート。
            　チェックの実行そのものが失敗したときはどこで失敗したかを含めそのログを作成し
            　プロセス用テーブルへインサート。
        ・print_check_results(results):を実行
            ・チェック実行結果をprint
        ・results(チェック実行結果)よりチェックが実行されたかを判定
            ・チェックが実行されていなかったらexit code 1を返す
                ・exit code 1はチェック実行されていなかったことを示す
                　チェック実行の結果、データに不備が発生したときはチェック実行自体は
                　成功となっている。データ不備はlookerstudio側で確認する。
                    ・どのようなデータ不備化はログで確認可能。
    


    ・def __init__(self, project_id="energy-env"):
        ・BQのプロジェクトID、チェックテーブル名やログのディレクトリ設定対応
        ・BQクライアント初期化
        ・BQログテーブル名定義
    ★BQおよびログに必要な情報を取得


    ・def run_all_checks(self, days=7):
        ・execution_id作成
        ・tryで以下対応
            ・errorなし
                ・power_results = self.check_power_data(days)実行
                    ・レコード数、NULL値、異常値のチェックを行いその結果にあわせた
            　      　辞書を作成しcheck_resultsとして返す
                ・weather_results = self.check_weather_data(days)を実行
                    ・気温、湿度、降水量のチェックを行いその結果にあわせた
            　      　辞書を作成しcheck_resultsとして返す
                ・電力と天気のチェック結果の辞書が入ったリストをall_resultsとして作成
                ・self._save_check_results(all_results)を実行
                    ・チェック結果をローカルに保存しBQの品質チェックのテーブルへ保存
                ・エラー、異常値、OKの件数をそれぞれカウント
                ・チェック結果をlog_dataという辞書に反映させる
                ・self._write_log(log_data)を実行
                    ・受け取ったログをローカルとBQのログテーブルへ保存。
        　          　テーブルへの保存失敗したらそのログをローカルに保存。
                ・print用にチェック結果の辞書を作成し返す
            ・errorあり
                ・電力、天気のチェック自体が実行できていないのでログとして作成。
                    ・エラー内のメッセージどこで実行できなかったかは把握可能。
                    ・self._write_log(log_data)を実行
                        ・受け取ったログをローカルとBQのログテーブルへ保存。
            　          　テーブルへの保存失敗したらそのログをローカルに保存。
                ・print用にエラー結果を辞書を作成し返す
    ★execution_id作成、電力、天気のチェックを行いその結果をチェックテーブルへインサート。
    　チェックの内容がダメでもログは作成されインサートされている。
    　インサート成功時は成功したことをプロセス用テーブルにログをインサート。
    　チェックの実行そのものが失敗したときはどこで失敗したかを含めそのログを作成し
    　プロセス用テーブルへインサート。


    ・def check_power_data(self, days=7):
        ・レコード欠損チェック
            ・期待されるレコード数は日数x24
            ・レコード数チェック用クエリを流して確認
                ・クエリ失敗はその旨のメッセージでraiseする
            ・結果をチェックテーブルのスキーマにあわせた辞書として作成
                ・結果があわなかったらその旨で辞書作成、raiseはしない
        ・NULL値チェック(使用電力)
            ・レコード数チェック用クエリを流して確認
                ・クエリ失敗はその旨のメッセージでraiseする
            ・結果をチェックテーブルのスキーマにあわせた辞書として作成
                ・結果があわなかったらその旨で辞書作成、raiseはしない
        ・NULL値チェック(供給電力)
            ・レコード数チェック用クエリを流して確認
                ・クエリ失敗はその旨のメッセージでraiseする
            ・結果をチェックテーブルのスキーマにあわせた辞書として作成
                ・結果があわなかったらその旨で辞書作成、raiseはしない
        ・異常値チェック(使用電力)
            ・レコード数チェック用クエリを流して確認
                ・クエリ失敗はその旨のメッセージでraiseする
            ・結果をチェックテーブルのスキーマにあわせた辞書として作成
                ・結果があわなかったらその旨で辞書作成、raiseはしない
        ・異常値チェック(供給電力)
            ・レコード数チェック用クエリを流して確認
                ・クエリ失敗はその旨のメッセージでraiseする
            ・結果をチェックテーブルのスキーマにあわせた辞書として作成
                ・結果があわなかったらその旨で辞書作成、raiseはしない
    ★レコード数、NULL値、異常値のチェックを行いその結果にあわせた
    　辞書を作成しcheck_resultsとして返す


    ・def check_weather_data(self, days=7):
        ・レコード欠損チェック
            ・期待されるレコード数は日数x24
            ・レコード数チェック用クエリを流して確認
                ・クエリ失敗はその旨のメッセージでraiseする
            ・結果をチェックテーブルのスキーマにあわせた辞書として作成
                ・結果があわなかったらその旨で辞書作成、raiseはしない
        ・NULL値チェック(気温)
            ・レコード数チェック用クエリを流して確認
                ・クエリ失敗はその旨のメッセージでraiseする
            ・結果をチェックテーブルのスキーマにあわせた辞書として作成
                ・結果があわなかったらその旨で辞書作成、raiseはしない
        ・NULL値チェック(湿度)
            ・レコード数チェック用クエリを流して確認
                ・クエリ失敗はその旨のメッセージでraiseする
            ・結果をチェックテーブルのスキーマにあわせた辞書として作成
                ・結果があわなかったらその旨で辞書作成、raiseはしない
        ・異常値チェック(気温)
            ・レコード数チェック用クエリを流して確認
                ・クエリ失敗はその旨のメッセージでraiseする
            ・結果をチェックテーブルのスキーマにあわせた辞書として作成
                ・結果があわなかったらその旨で辞書作成、raiseはしない
        ・異常値チェック(湿度)
            ・レコード数チェック用クエリを流して確認
                ・クエリ失敗はその旨のメッセージでraiseする
            ・結果をチェックテーブルのスキーマにあわせた辞書として作成
                ・結果があわなかったらその旨で辞書作成、raiseはしない
        ・異常値チェック(降水量)
            ・レコード数チェック用クエリを流して確認
                ・クエリ失敗はその旨のメッセージでraiseする
            ・結果をチェックテーブルのスキーマにあわせた辞書として作成
                ・結果があわなかったらその旨で辞書作成、raiseはしない
    ★気温、湿度、降水量のチェックを行いその結果にあわせた
    　辞書を作成しcheck_resultsとして返す


    ・def _save_check_results(self, check_results):
        ・check_results(チェック結果)が無ければエラーを返す
        ・チェック結果をローカルにjsonとして保存
        ・チェック結果を品質チェックのテーブルへ保存
    ★チェック結果をローカルに保存しBQの品質チェックのテーブルへ保存


    ・def _write_log(self, log_data):
        ・受け取ったlog_dataをjsonとしてローカルに書き込み
        ・log_dataをBQにインサート
            ・インサート失敗時はそのログをローカルのみに保存
    ★受け取ったログをローカルとBQのログテーブルへ保存。
    　テーブルへの保存失敗したらそのログをローカルに保存。


    ・def print_check_results(results):
    ★チェック実行結果をprint